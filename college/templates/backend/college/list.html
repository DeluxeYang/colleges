{% extends "backend/base.html" %}


{% block content %}

<div class="row">
    <div class="panel panel-default">
        <div class="panel panel-default">
            <div class="panel-heading">
                院校信息
            </div>
            <div class="panel-body">
                <div class="table-responsive">
                    <table class="table table-striped table-bordered table-hover" id="dataTables-example">
                        <thead>
                            <tr>
                                {% for field in fields %}
                                <th>{{ field }}</th>
                                {% endfor %}
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="/static/js/dataTables/jquery.dataTables.js"></script>
<script src="/static/js/dataTables/dataTables.bootstrap.js"></script>
<script>
$(document).ready(function () {
    $('#dataTables-example').DataTable( {
        "ajax": '{{ get_all_college_url }}'
    } );
});
function href_ajax(_id) {
    function getCookie(name) {
        var arr,reg=new RegExp("(^| )"+name+"=([^;]*)(;|$)"); //正则匹配
        if(arr=document.cookie.match(reg)){
          return unescape(arr[2]);
        }
        else{
         return null;
        }
    }
    $.ajax({
        type: "post",
        url: "{{ file_delete_url }}",
        data: {"college_id": _id, "csrfmiddlewaretoken": getCookie('csrftoken')},
        dataType:"json",
        success: function(data)  {
            var _table = $('#dataTables-example').DataTable();
            $('#alert-success').css("display", "block");
            _table.row($("#row_"+_id).parents('tr')).remove().draw();
            if(data["success"]){
                $('#messages').append('<div class="alert alert-success"> <a class="close" data-dismiss="alert">×</a>'+data["success"]+' </div>');
            }else{
                $('#messages').append('<div class="alert alert-danger"> <a class="close" data-dismiss="alert">×</a>'+data["error"]+' </div>')
            }
        }
    });
}
</script>

{% endblock %}